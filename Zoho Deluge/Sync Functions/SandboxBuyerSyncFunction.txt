void automation.SandboxBuyerSyncFunction(Int leadId)
{
// info "Processing Lead ID: " + leadId;
leadData = zoho.crm.getRecordById("Leads",leadId);
// info leadData;
try 
{
	if(leadData == null)
	{
		info "Failed to fetch Lead data - leadData is null";
		return;
	}
	leadIdStr = leadId.toString();
	webhookPayload = Map();
	webhookPayload.put("Lead_Id",leadIdStr);
	webhookPayload.put("Phone",leadData.get("Phone"));
	webhookPayload.put("Email",leadData.get("Email"));
	fullName = ifnull(leadData.get("First_Name"),"") + " " + ifnull(leadData.get("Last_Name"),"");
	webhookPayload.put("Lead_Name",ifnull(fullName,"").trim());
	webhookPayload.put("Lead_Source",ifnull(leadData.get("Lead_Source"),""));
	webhookPayload.put("Lead_Status",ifnull(leadData.get("Lead_Status"),""));
	webhookPayload.put("Page_Name",ifnull(leadData.get("Page_Name"),""));
	webhookPayload.put("Page_ID",ifnull(leadData.get("Page_ID"),""));
	webhookPayload.put("Birth_Date",ifnull(leadData.get("Birth_Date"),""));
	webhookPayload.put("Is_Active","true");
	webhookPayload.put("User_Type","Buyer");
	webhookPayload.put("Previous_Lead_Status",ifnull(leadData.get("Previous_Lead_Status"),""));
	webhookPayload.put("Created_Time",ifnull(leadData.get("Created_Time"),""));
	webhookPayload.put("Modified_Time",ifnull(leadData.get("Modified_Time"),""));
	webhookPayload.put("Duplicate_Status",ifnull(leadData.get("Duplicate_Status"),""));
	webhookPayload.put("Duplicate_Lead",ifnull(leadData.get("Duplicate_Lead"),""));
	owner = leadData.get("Owner");
	if(owner != null)
	{
		webhookPayload.put("Lead_Owner",ifnull(owner.get("name"),""));
	}
	else
	{
		webhookPayload.put("Lead_Owner","");
	}
	webhookPayload.put("Priority",ifnull(leadData.get("Priority"),""));
	webhookPayload.put("Listing_Platform",ifnull(leadData.get("Listing_Platform"),""));
	webhookPayload.put("Project_name",ifnull(leadData.get("Project_name"),""));
	webhookPayload.put("Campaign_Name",ifnull(leadData.get("Form_Name"),""));
	webhookPayload.put("Campaign",ifnull(leadData.get("Campaign_Name"),""));
	webhookPayload.put("Ad_set",ifnull(leadData.get("Ad_set"),"NA"));
	webhookPayload.put("Form_ID",ifnull(leadData.get("Form_ID"),"NA"));
	webhookPayload.put("Social_Lead_ID",ifnull(leadData.get("leadchain0__Social_Lead_ID"),""));
	webhookPayload.put("Ad_Name",ifnull(leadData.get("Ad_Name"),""));
	webhookPayload.put("No_Of_attempts",ifnull(leadData.get("No_Of_attempts"),"0"));
	webhookPayload.put("Interested_in_visit",ifnull(leadData.get("Interested_in_visit"),""));
	webhookPayload.put("Preferences",ifnull(leadData.get("Preferences"),""));
	webhookPayload.put("Use_Case",ifnull(leadData.get("Use_Case"),""));
	webhookPayload.put("Preferred_Area",ifnull(leadData.get("Preferred_Area"),""));
	webhookPayload.put("Current_Stay",ifnull(leadData.get("Current_Stay"),""));
	webhookPayload.put("Budget",ifnull(leadData.get("Budget"),""));
	webhookPayload.put("Preferred_time_of_Visit",ifnull(leadData.get("Preferred_time_of_Visit"),""));
	webhookPayload.put("Not_Qualified_Reason",ifnull(leadData.get("Not_Qualified_Reason"),""));
	webhookPayload.put("Tag_Expiry_Date",ifnull(leadData.get("Tag_Expiry_Date"),""));
	webhookPayload.put("User_Type","Buyer");
	micromarket = ifnull(leadData.get("Truva_Micromarket"),list());
	cleanMicromarket = list();
	for each  item in micromarket
	{
		if(item != null && item != "" && item != "null")
		{
			cleanMicromarket.add(item);
		}
	}
	webhookPayload.put("Truva_Micromarket",cleanMicromarket);
	webhookPayload.put("DND",leadData.get("DND"));
	webhookPayload.put("Referred_by",leadData.get("Referred_by"));
	webhookPayload.put("Spouse_Name",leadData.get("Spouse_Name"));
	webhookPayload.put("Spouse_Phone",leadData.get("Spouse_Phone"));
	webhookPayload.put("CP_Contact_Name",null);
	webhookPayload.put("CP_Phone",null);
	webhookPayload.put("CP_Id",null);
	webhookPayload.put("Company_lookup",null);
	channelPartnerLookup = leadData.get("Channel_Partner");
	info "Channel Partner lookup raw value: " + channelPartnerLookup;
	if(channelPartnerLookup != null && channelPartnerLookup != "")
	{
		if(channelPartnerLookup.containKey("id"))
		{
			cpId = channelPartnerLookup.get("id");
			info "Channel Partner ID: " + cpId;
			cpDetails = zoho.crm.getRecordById("Accounts",cpId);
			info "CP Details: " + cpDetails;
			if(cpDetails != null)
			{
				info "Channel Partner data fetched successfully";
				webhookPayload.put("CP_Contact_Name",cpDetails.get("Contact_name"));
				webhookPayload.put("CP_Phone",cpDetails.get("Phone"));
				webhookPayload.put("CP_Id",cpId);
				webhookPayload.put("Company_lookup",cpDetails.get("Company_lookup"));
				info "Channel Partner Contact Name: " + cpDetails.get("Contact_name");
				info "Channel Partner Phone: " + cpDetails.get("Phone");
			}
			else
			{
				info "Failed to fetch Channel Partner data by cpId: " + cpId;
			}
		}
		else
		{
			info "Channel Partner lookup exists but 'id' key not found; leaving CP fields null";
		}
	}
	else
	{
		info "No Channel Partner linked to this lead â€” CP fields set to null";
	}
	info webhookPayload;
	apiendpoint = "https://qqvnbapdea.execute-api.ap-south-1.amazonaws.com/prod/sandbox-netcore-sync";
	response = invokeurl
	[
		url :apiendpoint
		type :POST
		parameters:webhookPayload.toString()
		headers:{"Content-Type":"application/json"}
	];
	info "API Response: " + response;
	if(response != null)
	{
		info "Webhook sent successfully for Lead ID: " + leadId;
	}
	else
	{
		info "Failed to send webhook for Lead ID: " + leadId;
	}
}
catch (error)
{
	info "error: " + error;
}
}