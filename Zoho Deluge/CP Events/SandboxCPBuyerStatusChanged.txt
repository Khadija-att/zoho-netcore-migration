void automation.SandboxCPBuyerStatusChanged(Int leadID,String leadHistory)
{
lead = zoho.crm.getRecordById("Leads",leadID);
webhookPayload = Map();
Channel_Partner = lead.get("Channel_Partner");
if(Channel_Partner != null)
{
	if(Channel_Partner.containKey("id"))
	{
		cpId = Channel_Partner.get("id");
		cpIdStr = cpId.toString();
		webhookPayload.put("Channel_Partner_Id",cpIdStr);
	}
}
webhookPayload.put("buyer_name",ifnull(lead.get("Full_Name"),""));
webhookPayload.put("buyer_source",ifnull(lead.get("Lead_Source"),""));
webhookPayload.put("new_buyer_status",ifnull(lead.get("Lead_Status"),""));
webhookPayload.put("previous_buyer_status",ifnull(leadHistory.get("Lead_Status"),""));
webhookPayload.put("tag_expiry_date",ifnull(lead.get("Tag_Expiry_Date"),""));
webhookPayload.put("User_Type","Channel Partner");
webhookPayload.put("activity_name","cp_buyer_lead_status_changed");
apiendpoint = "https://qqvnbapdea.execute-api.ap-south-1.amazonaws.com/prod/sandbox-netcore-event";
resp = invokeurl
[
	url :apiendpoint
	type :POST
	parameters:webhookPayload.toString()
	headers:{"Content-Type":"application/json"}
];
info "Netcore event sent. Response: " + resp.toString();
}